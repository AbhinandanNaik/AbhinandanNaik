name: Magma Dashboard

on:
  # 1. Run daily at midnight
  schedule: [{cron: "0 0 * * *"}]
  # 2. Run whenever you push to main
  push: {branches: ["master", "main"]}
  # 3. Allow manual trigger
  workflow_dispatch:

jobs:
  github-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # ----------------------------------------------------------------
      # JOB 1: Generate the "Fire City" (Isometric Calendar)
      # ----------------------------------------------------------------
      - name: Generate Fire City
        uses: lowlighter/metrics@latest
        with:
          filename: fire-city.svg
          token: ${{ secrets.GITHUB_TOKEN }}
          base: "" # No header, just the graph
          
          # Isometric Calendar Settings
          plugin_isocalendar: yes
          plugin_isocalendar_duration: full-year
          
          # ☢️ NUCLEAR FIRE PALETTE ☢️
          # 0 (Empty)  = #450a0a (Dark Magma Floor - VISIBLE)
          # 1 (Low)    = #ff4d00 (Neon Orange - INSTANT FIRE)
          # 2 (Med)    = #ff9500 (Bright Orange)
          # 3 (High)   = #ffdd00 (Sun Yellow)
          # 4 (Max)    = #ffffff (White Hot Plasma)
          plugin_isocalendar_colors: "#450a0a,#ff4d00,#ff9500,#ffdd00,#ffffff"

      # ----------------------------------------------------------------
      # JOB 2: Generate the Stats Dashboard (Langs + Stats)
      # ----------------------------------------------------------------
      - name: Generate Stats Dashboard
        uses: lowlighter/metrics@latest
        with:
          filename: stats-dashboard.svg
          token: ${{ secrets.GITHUB_TOKEN }}
          base: header, activity, community, repositories, metadata
          config_timezone: Asia/Kolkata
          
          # Language Settings (The Donut Chart)
          plugin_languages: yes
          plugin_languages_ignored: >-
            html, css
          plugin_languages_limit: 8
          plugin_languages_sections: most-used
          plugin_languages_colors: "github"
